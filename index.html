<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Flexible Portfolio</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/FontLoader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/geometries/TextGeometry.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
  <style>
    body { margin: 0; overflow: hidden; background: black; }
    canvas { display: block; }
  </style>
</head>
<body>
<script>
  // === CONFIG TEXT ===
  const TEXTS = [
    { 
      text: "Bima Sakti", 
      position: [0, -8, 0], 
      size: 1, height: 0.2, 
      color: 0x00ffff, 
      rotation: [0, 0, 0], 
      bevel: true,
      glow: false
    },
    { 
      text: "Portfolio 3D", 
      position: [0, -7, 0], 
      size: 1, height: 0.2, 
      color: 0xff0000, 
      rotation: [0, 0, 0], 
      bevel: true,
      glow: false
    }
  ];

  // === CONFIG MODELS ===
  const MODELS = [
    { path: "Space_rocket.glb", scale: [1,1,1], position: [0, -5, 0], rotation: [0,0,0], autoRotate: true },
  ];

  let scene, camera, renderer, controls, stars;
  const fontLoader = new THREE.FontLoader();
  const gltfLoader = new THREE.GLTFLoader();

  // === Keyboard Control Vars ===
  let keys = {};
  document.addEventListener("keydown", (e) => { keys[e.code] = true; });
  document.addEventListener("keyup", (e) => { keys[e.code] = false; });

  function keyboardControls() {
    const speed = 0.2;
    if (keys["KeyW"]) camera.position.z -= speed;
    if (keys["KeyS"]) camera.position.z += speed;
    if (keys["KeyA"]) camera.position.x -= speed;
    if (keys["KeyD"]) camera.position.x += speed;
    if (keys["KeyQ"]) camera.position.y -= speed;
    if (keys["KeyE"]) camera.position.y += speed;
  }

  function init() {
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.set(0, 0, 15);

    renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Cahaya
    scene.add(new THREE.AmbientLight(0xffffff, 0.6));
    const pointLight = new THREE.PointLight(0xffffff, 1);
    pointLight.position.set(10,10,10);
    scene.add(pointLight);

    // Bintang galaxy
    const starGeometry = new THREE.BufferGeometry();
    const starCount = 3000;
    const starPositions = new Float32Array(starCount*3);
    for (let i=0;i<starCount*3;i++) starPositions[i] = (Math.random()-0.5)*400;
    starGeometry.setAttribute("position", new THREE.BufferAttribute(starPositions,3));
    const starMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 1, transparent:true, opacity:0.9 });
    stars = new THREE.Points(starGeometry, starMaterial);
    scene.add(stars);

    // Load semua Text & Model
    TEXTS.forEach(t => loadText(t));
    MODELS.forEach(m => loadModel(m));

    // === Load Foto Profil ===
    const loader = new THREE.TextureLoader();
    loader.load('BimaJPG.jpg', function(texture){
        const geometry = new THREE.PlaneGeometry(5,5);
        const material = new THREE.MeshBasicMaterial({ map: texture });
        const plane = new THREE.Mesh(geometry, material);
        plane.position.set(0, -12, 0); // posisi kanan rocket
        scene.add(plane);
    });

    // Controls
    controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.05;
    controls.enablePan = true;
    controls.minDistance = 0;
    controls.maxDistance = 500;

    window.addEventListener("resize", onWindowResize, false);
  }

  function loadText(cfg) {
    fontLoader.load("https://threejs.org/examples/fonts/helvetiker_regular.typeface.json", function(font){
      const textGeometry = new THREE.TextGeometry(cfg.text, {
        font: font,
        size: cfg.size || 1,
        height: cfg.height || 0.2,
        curveSegments: 12,
        bevelEnabled: cfg.bevel || false,
        bevelThickness: 0.03,
        bevelSize: 0.03,
        bevelSegments: 3
      });
      let mat = new THREE.MeshStandardMaterial({ color: cfg.color || 0xffffff, metalness: 0.8, roughness: 0.3 });
      const textMesh = new THREE.Mesh(textGeometry, mat);
      textGeometry.center();
      textMesh.position.set(...(cfg.position || [0,0,0]));
      textMesh.rotation.set(...(cfg.rotation || [0,0,0]));
      if(cfg.glow){
        const glow = new THREE.MeshBasicMaterial({ color: cfg.color || 0xffffff });
        textMesh.material = [mat, glow];
      }
      scene.add(textMesh);
    });
  }

  function loadModel(cfg) {
    gltfLoader.load(cfg.path, function(gltf){
      const model = gltf.scene;
      model.scale.set(...(cfg.scale || [1,1,1]));
      model.position.set(...(cfg.position || [0,0,0]));
      model.rotation.set(...(cfg.rotation || [0,0,0]));
      scene.add(model);
      if(cfg.autoRotate){
        function rotate(){
          requestAnimationFrame(rotate);
          model.rotation.y += 0.003;
        }
        rotate();
      }
    });
  }

  function onWindowResize(){
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  }

  function animate(){
    requestAnimationFrame(animate);
    keyboardControls();
    stars.rotation.y += 0.00005;
    controls.update();
    renderer.render(scene,camera);
  }

  init();
  animate();
</script>
</body>
</html>
